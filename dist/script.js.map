{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/index.js","webpack:///./src/js/createDomTree.js","webpack:///./src/js/keyboard.js","webpack:///./src/js/keyboardEventHandler.js","webpack:///./src/js/keyboardLayoutEnRu.js"],"names":[],"mappings":";QAAA;QACA;;QAEA;QACA;;QAEA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;;QAEA;QACA;;QAEA;QACA;;QAEA;QACA;QACA;;;QAGA;QACA;;QAEA;QACA;;QAEA;QACA;QACA;QACA,0CAA0C,gCAAgC;QAC1E;QACA;;QAEA;QACA;QACA;QACA,wDAAwD,kBAAkB;QAC1E;QACA,iDAAiD,cAAc;QAC/D;;QAEA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA,yCAAyC,iCAAiC;QAC1E,gHAAgH,mBAAmB,EAAE;QACrI;QACA;;QAEA;QACA;QACA;QACA,2BAA2B,0BAA0B,EAAE;QACvD,iCAAiC,eAAe;QAChD;QACA;QACA;;QAEA;QACA,sDAAsD,+DAA+D;;QAErH;QACA;;;QAGA;QACA;;;;;;;;;;;;;AClFA;AAAA;AAAA;AAAA;AAAuC;AACU;AACc;;AAE/D;AACA,EAAE,uEAAa;;;AAGf,EAAE,qDAAQ;;AAEV;;AAEA,qDAAqD,+CAA+C;AACpG,8BAA8B;AAC9B,oBAAoB;AACpB,CAAC;;;;;;AAMD;;;;;;;;;;;;;;;;;ACnBO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;;AAGA;AACA;;;AAGA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,C;;;;;;;;;;;;AC7CA;AAAA;AAAA;AAAA;AAA8D;AACJ;AACA;AACN;AACD;;AAE5C;AACP;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB,sEAAkB;AACvC,eAAe,gEAAY;AAC3B;AACA;AACA,gBAAgB,mCAAmC;AACnD,eAAe,sEAAkB;AACjC;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA,eAAe,uEAAW;AAC1B;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,IAAI,kFAAoB;;AAExB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT,OAAO;AACP,KAAK;AACL,GAAG;;AAEH;AACA;;AAEA;AACA;AACA,0CAA0C,SAAS;AACnD;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,WAAW;;AAEX;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;;AAEX;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;;AAEX;;AAEA;AACA;AACA;;AAEA;AACA;AACA,WAAW;;AAEX;;AAEA;AACA;AACA;;AAEA;AACA;AACA,WAAW;;AAEX;;AAEA;AACA;AACA;;AAEA;AACA;AACA,WAAW;;AAEX;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;;AAEX;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,uC;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,WAAW;;AAEX;;AAEA;AACA;AACA;;AAEA;AACA;AACA,WAAW;AACX;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;;AAEA;AACA;AACA;;AAEA;AACA;AACA,WAAW;AACX;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;;AAEA;AACA;;AAEA;AACA;AACA,WAAW;;AAEX;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA,oD;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA,GAAG;AACH;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;;;;;;;;;;;;AC/aA;AAAA;AAAO;;AAEP;AACA;;AAEA;;;AAGA;AACA;;;AAGA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA,GAAG;AACH,E;;;;;;;;;;;;;;;;;;AC9DA;AACO,4B;AACP;AACA;AACA;AACA;AACA,uCAAuC;AACvC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B;AAC3B,2BAA2B;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEO;AACA;;AAEA;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,c;AACA;AACA;AACA,c;AACA;AACA,c;AACA,C","file":"script.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./src/index.js\");\n","import {Keyboard} from './js/keyboard';\r\nimport {createDomTree} from './js/createDomTree';\r\nimport {keyboardEventHandler} from './js/keyboardEventHandler';\r\n\r\nwindow.addEventListener('DOMContentLoaded', function() {\r\n  createDomTree();\r\n  \r\n  \r\n  Keyboard.init(document.querySelector('.keyboard > .wrapper'));\r\n    \r\n  //keyboardEventHandler(Keyboard);\r\n\r\n  // Keyboard.open('dcode', function (currentValue) {console.log('value changed: ' + currentValue);},\r\n  // function (currentValue) {console.log('keyboard closed! Finishen value: ' + \r\n  // currentValue);});\r\n});\r\n\r\n\r\n\r\n\r\n\r\n//https://www.youtube.com/watch?v=N3cq0BHDMOY\r\n","\r\n\r\nexport const createDomTree = () => {\r\n  console.log('domTree');\r\n  const header = document.createElement('header');\r\n  const main = document.createElement('main');\r\n  const footer = document.createElement('footer');\r\n  const div = document.createElement('div');\r\n  const textarea = document.createElement('textarea');\r\n  const textarea1 = document.createElement('textarea');\r\n  div.classList.add('wrapper');\r\n  header.classList.add('header');\r\n  header.append(div);\r\n  main.classList.add('main');\r\n  footer.classList.add('footer');\r\n  footer.append(div);\r\n    \r\n  const screen = createSection('screen');\r\n  const keyboard = createSection('keyboard');\r\n  \r\n  \r\n  main.append(screen);\r\n  main.append(keyboard);\r\n  \r\n  \r\n  document.body.append(header);\r\n  document.body.append(main);\r\n  document.body.append(footer);\r\n  \r\n  textarea.classList.add('textarea', 'use-keyboard-input');\r\n  textarea1.classList.add('textarea');\r\n  document.querySelector('.screen > .wrapper')\r\n          .appendChild(textarea);\r\n  document.querySelector('.screen > .wrapper')\r\n          .appendChild(textarea1);\r\n\r\n};\r\n\r\nfunction createSection(className) {\r\n  const section = document.createElement('section');\r\n  const div = document.createElement('div');\r\n  div.classList.add('wrapper');\r\n  if (className) section.classList.add(className);\r\n  section.append(div);\r\n  return section;\r\n}","import { keyboardEventHandler } from './keyboardEventHandler';\r\nimport { keyboardLayoutEnRu } from './keyboardLayoutEnRu';\r\nimport { brakingElementsArr } from './keyboardLayoutEnRu';\r\nimport { languagesArr } from './keyboardLayoutEnRu';\r\nimport { getLanguage } from './keyboardLayoutEnRu';\r\n\r\nexport const Keyboard = {\r\n  elements: {\r\n    main: null,\r\n    keyboardContainer: null,\r\n    keys: []\r\n  },\r\n\r\n  eventHandlers: {\r\n    onInput: null,\r\n    onClose: null\r\n  },\r\n\r\n  properties: {\r\n    value: '',\r\n    isOpen: false,\r\n    capsLock: false, // caps lock status to toggle case\r\n    shift: false, // shift status to toggle case\r\n    shiftDown: false, // shift status to allow click shift + key by mouse\r\n    brakingElements: brakingElementsArr,\r\n    languages: languagesArr,\r\n    currentLang: 'En',\r\n    alt: 'Alt',\r\n    langIndex: { En: 0, EnAlt: 1, Ru: 2, RuAlt: 3 },\r\n    keyLayout: keyboardLayoutEnRu,\r\n    input: null,\r\n    caretIndex: 0,\r\n    elementsPerLine: 127\r\n  },\r\n\r\n  init(container) {\r\n    // check google chrome language\r\n    let lang = getLanguage();\r\n    // create keyboard\r\n    this.properties.currentLang = sessionStorage.getItem('language') || lang;\r\n    console.log('init with currentLang ' + lang);\r\n    this.elements.main = document.createElement('div');\r\n    this.elements.keyboardContainer = document.createElement('div');\r\n\r\n    // setup keyboard elements\r\n    this.elements.main.classList.add('keyboard-panel', 'keyboard-panel_hidden');\r\n\r\n    this.elements.keyboardContainer.classList.add('keyboard-panel__keys');\r\n    this.elements.keyboardContainer.appendChild(this._createKeys());\r\n    this.elements.keys = this.elements.keyboardContainer.querySelectorAll(\r\n      '.key'\r\n    );\r\n\r\n    // add to DOM\r\n    this.elements.main.appendChild(this.elements.keyboardContainer);\r\n    container.appendChild(this.elements.main);\r\n\r\n    // add keyboard events handlers\r\n    keyboardEventHandler(this);\r\n\r\n    // automatically use keyboard for elements with  .use-keyboard-input\r\n    document.querySelectorAll('.use-keyboard-input').forEach(element => {\r\n      element.addEventListener('focus', () => {\r\n        this.open(element, element.value, currentValue => {\r\n          element.value = currentValue;\r\n          console.log(element.selectionStart);\r\n          element.focus();\r\n        });\r\n      });\r\n    });\r\n  },\r\n\r\n  _createKeys() {\r\n    const fragment = document.createDocumentFragment();\r\n    \r\n    // create HTML for an icon\r\n    const createIconHTML = iconName => {\r\n      return `<i class='material-icons'>${iconName}</i>`;\r\n    };\r\n    for (let keyCode in this.properties.keyLayout) {\r\n      // choose proper value according to current currentLang\r\n\r\n      const key = this.properties.keyLayout[keyCode][\r\n        this.properties.langIndex[this.properties.currentLang]\r\n      ];\r\n      const keyElement = document.createElement('div');\r\n      const keyContent = document.createElement('span');\r\n      const insertLineBreak =\r\n        this.properties.brakingElements.indexOf(keyCode) !== -1;\r\n\r\n      //add classes\r\n      keyElement.classList.add('key');\r\n      // special keys\r\n      switch (keyCode) {\r\n        case 'Led':\r\n          keyElement.classList.add('special');\r\n          keyContent.innerHTML = createIconHTML('highlight');\r\n          keyElement.addEventListener('click', () => {\r\n            for (const key of this.elements.keys) {\r\n              key.classList.toggle('key_led');\r\n            }\r\n          });\r\n          break;\r\n\r\n        case 'Lang':\r\n          keyElement.classList.add('special');\r\n          keyContent.textContent = this.properties.currentLang;\r\n          keyElement.appendChild(keyContent);\r\n\r\n          keyElement.addEventListener('click', () => {\r\n            this.changeLanguageLayout();\r\n          });\r\n\r\n          break;\r\n\r\n        case 'Backspace':\r\n          keyElement.classList.add('key_medium', 'special');\r\n          keyContent.innerHTML = createIconHTML('backspace');\r\n          keyElement.appendChild(keyContent);\r\n          keyElement.addEventListener('click', () => {\r\n            this._deleteSymbol(keyCode);\r\n          });\r\n\r\n          break;\r\n\r\n        case 'CapsLock':\r\n          keyElement.classList.add('key_medium', 'key_activatable', 'special');\r\n          keyContent.innerHTML = createIconHTML('keyboard_capslock');\r\n          keyElement.appendChild(keyContent);\r\n          keyElement.addEventListener('mouseup', () => {\r\n            this._toggleCapsLock();\r\n            keyElement.classList.toggle(\r\n              'key_activatable_active',\r\n              this.properties.capsLock\r\n            );\r\n          });\r\n\r\n          break;\r\n\r\n        case 'Enter':\r\n          keyElement.classList.add('key_medium', 'special');\r\n          keyContent.innerHTML = createIconHTML('keyboard_return');\r\n\r\n          keyElement.addEventListener('click', () => {\r\n            this._pastSymbol('\\n');\r\n          });\r\n\r\n          break;\r\n\r\n        case 'Space':\r\n          keyElement.classList.add('key_extra-wide', 'special');\r\n          keyContent.innerHTML = createIconHTML('space_bar');\r\n\r\n          keyElement.addEventListener('click', () => {\r\n            this._pastSymbol(' ');\r\n          });\r\n\r\n          break;\r\n\r\n        case 'Tab':\r\n          keyElement.classList.add('key_medium', 'special');\r\n          keyContent.innerHTML = createIconHTML('keyboard_tab');\r\n\r\n          keyElement.addEventListener('click', () => {\r\n            this._pastSymbol('\\t');\r\n          });\r\n\r\n          break;\r\n\r\n        case 'ShiftLeft':\r\n        case 'ShiftRight':\r\n          keyElement.classList.add('key_medium', 'special');\r\n          keyContent.textContent = key;\r\n          keyElement.addEventListener('mousedown', () => {\r\n            // cant press shift if it is pressed already\r\n            if (!this.properties.shiftDown) {\r\n              this._toggleShift();\r\n              this.properties.shiftDown = true;\r\n              keyElement.classList.add('key_active');\r\n            }\r\n          });\r\n          keyElement.addEventListener('mouseup', event => {\r\n            // cant press shift if it is pressed already\r\n            if (this.properties.shiftDown) {\r\n              this._toggleShift();\r\n              this.properties.shiftDown = false;\r\n              keyElement.classList.remove('key_active');\r\n            }\r\n          });\r\n\r\n          break;\r\n\r\n        case 'ControlRight':\r\n        case 'ControlLeft':\r\n          keyElement.classList.add('key_medium', 'special');\r\n          keyContent.textContent = key;\r\n\r\n          break;\r\n\r\n        case 'AltLeft':\r\n        case 'AltRight':\r\n          keyElement.classList.add('key_medium', 'special');\r\n          keyContent.textContent = key;          \r\n          break;\r\n\r\n        case 'Delete':\r\n          keyElement.classList.add('key_medium', 'special');\r\n          keyContent.textContent = key;\r\n          keyElement.addEventListener('click', () => {\r\n            this._deleteSymbol(keyCode);\r\n          });\r\n          break;\r\n\r\n        case 'Done':\r\n          keyElement.classList.add('special');\r\n          keyContent.innerHTML = createIconHTML('keyboard_hide');\r\n\r\n          keyElement.addEventListener('click', () => {\r\n            this.properties.value += ' ';\r\n            this.close();\r\n            this._triggerEvent('onClose');\r\n          });\r\n\r\n          break;\r\n\r\n        case 'ArrowUp':\r\n          keyElement.classList.add('special');\r\n          keyContent.innerHTML = createIconHTML('keyboard_arrow_up');\r\n\r\n          keyElement.addEventListener('click', () => {\r\n            this._pastSymbol('↑');\r\n          });\r\n          break;\r\n\r\n        case 'ArrowLeft':\r\n          keyElement.classList.add('special');\r\n          keyContent.innerHTML = createIconHTML('keyboard_arrow_left');\r\n\r\n          keyElement.addEventListener('click', () => {\r\n            let caretInd = this.properties.input.selectionStart;\r\n            if (caretInd > 0) {\r\n              this.properties.input.setSelectionRange(\r\n                caretInd - 1,\r\n                caretInd - 1\r\n              );\r\n            }\r\n            this._triggerEvent('onInput');\r\n          });\r\n          break;\r\n\r\n        case 'ArrowDown':\r\n          keyElement.classList.add('special');\r\n          keyContent.innerHTML = createIconHTML('keyboard_arrow_down');\r\n\r\n          keyElement.addEventListener('click', () => {\r\n            this._pastSymbol('↓');\r\n          });\r\n          break;\r\n\r\n        case 'ArrowRight':\r\n          keyElement.classList.add('special');\r\n          keyContent.innerHTML = createIconHTML('keyboard_arrow_right');\r\n\r\n          keyElement.addEventListener('click', () => {\r\n            let caretInd = this.properties.input.selectionStart;\r\n            if (caretInd <= this.properties.input.value.length) {\r\n              this.properties.input.setSelectionRange(\r\n                caretInd + 1,\r\n                caretInd + 1\r\n              );\r\n            }\r\n            this._triggerEvent('onInput');\r\n          });\r\n          break;\r\n\r\n        default:\r\n          keyContent.textContent = key;\r\n\r\n          keyElement.addEventListener('click', () => {\r\n            this._pastSymbol(keyContent.textContent);\r\n          });\r\n\r\n          break;\r\n      }\r\n      keyElement.setAttribute('id', keyCode);\r\n      keyElement.appendChild(keyContent);\r\n      fragment.appendChild(keyElement);\r\n\r\n      if (insertLineBreak) {\r\n        fragment.appendChild(document.createElement('br'));\r\n      }\r\n    }\r\n    return fragment;\r\n  },\r\n\r\n  _triggerEvent(handlerName) {\r\n    if (typeof this.eventHandlers[handlerName] == 'function') {\r\n      this.eventHandlers[handlerName](this.properties.value);\r\n    }\r\n  },\r\n\r\n  _toggleCapsLock() {\r\n    this.properties.capsLock = !this.properties.capsLock;\r\n\r\n    for (const key of this.elements.keys) {\r\n      if (!key.classList.contains('special')) {\r\n        // caps lock only change case\r\n        key.children[0].textContent =\r\n          this.properties.capsLock ^ this.properties.shift\r\n            ? key.children[0].textContent.toUpperCase()\r\n            : key.children[0].textContent.toLowerCase();\r\n      }\r\n    }\r\n  },\r\n\r\n  _toggleShift() {\r\n    this.properties.shift = !this.properties.shift;\r\n\r\n    for (const key of this.elements.keys) {\r\n      if (!key.classList.contains('special')) {\r\n        // choose basic or alt layout for given currentLang\r\n        let charIndex = this.properties.shift\r\n          ? this.properties.langIndex[\r\n              this.properties.currentLang + this.properties.alt\r\n            ]\r\n          : this.properties.langIndex[this.properties.currentLang];\r\n        // change case for given layout based on shift and caps\r\n        key.children[0].textContent =\r\n          this.properties.capsLock ^ this.properties.shift\r\n            ? this.properties.keyLayout[key.id][charIndex].toUpperCase()\r\n            : this.properties.keyLayout[key.id][charIndex].toLowerCase();\r\n      }\r\n    }\r\n  },\r\n\r\n  changeLanguageLayout() {\r\n    this._changeLanguage();\r\n    sessionStorage.setItem('language', this.properties.currentLang);\r\n\r\n    for (const key of this.elements.keys) {\r\n      // choose basic or alt layout for given currentLang\r\n      let charIndex = this.properties.shift\r\n        ? this.properties.langIndex[\r\n            this.properties.currentLang + this.properties.alt\r\n          ] // !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!\r\n        : this.properties.langIndex[this.properties.currentLang];\r\n\r\n      if (!key.classList.contains('special')) {\r\n        // change case for given layout based on shift and caps\r\n        key.children[0].textContent =\r\n          this.properties.capsLock ^ this.properties.shift\r\n            ? this.properties.keyLayout[key.id][charIndex].toUpperCase()\r\n            : this.properties.keyLayout[key.id][charIndex].toLowerCase();\r\n      } else if (key.id === 'Lang') {\r\n        // change language special key content\r\n        key.children[0].textContent = this.properties.keyLayout[key.id][\r\n          charIndex\r\n        ];\r\n      }\r\n    }\r\n  },\r\n  // change current language to the next from languages array\r\n  _changeLanguage() {\r\n    let currentIndex = this.properties.languages.indexOf(\r\n      this.properties.currentLang\r\n    );\r\n    let nextIndex =\r\n      (currentIndex + 1 + this.properties.languages.length) %\r\n      this.properties.languages.length;\r\n    this.properties.currentLang = this.properties.languages[nextIndex];\r\n  },\r\n\r\n  _pastSymbol(symbol) {\r\n    let caretInd = this.properties.input.selectionStart;\r\n    if (caretInd === this.properties.input.value.length) {\r\n      this.properties.value += symbol;\r\n    } else {\r\n      let temp = this.properties.value.split('');\r\n      temp.splice(caretInd, 0, symbol);\r\n      temp = temp.join('');\r\n\r\n      this.properties.value = temp;\r\n      this._triggerEvent('onInput');\r\n      this.properties.input.setSelectionRange(caretInd + 1, caretInd + 1);\r\n    }\r\n    this._triggerEvent('onInput');\r\n  },\r\n  _deleteSymbol(operation) {\r\n      let shift = (operation === 'Delete') ? 0 : -1; \r\n      let caretInd = this.properties.input.selectionStart+shift;\r\n      if(caretInd <= this.properties.value.length-1 &&  caretInd >= 0) {\r\n        \r\n      let temp = this.properties.value.split('');\r\n      temp.splice(caretInd, 1);\r\n      temp = temp.join('');\r\n\r\n      this.properties.value = temp;\r\n      this._triggerEvent('onInput');\r\n      this.properties.input.setSelectionRange(caretInd, caretInd);\r\n      this._triggerEvent('onInput');\r\n      }\r\n  },\r\n\r\n  animateKeyDown(key) {\r\n    key.classList.add('key_active');\r\n  },\r\n  animateKeyUp(key) {\r\n    key.classList.remove('key_active');\r\n  },\r\n\r\n  open(element, initialValue, onInput, onClose) {\r\n    this.properties.input = element;\r\n    console.log('open on element ' + element);\r\n    console.log(element.selectionStart);\r\n    this.properties.value = initialValue || '';\r\n    this.eventHandlers.onInput = onInput;\r\n    this.eventHandlers.onClose = onClose;\r\n    this.elements.main.classList.remove('keyboard-panel_hidden');\r\n    this.properties.isOpen = true;\r\n  },\r\n\r\n  close() {\r\n    console.log('close');\r\n    this.properties.value = '';\r\n    this.eventHandlers.onInput = null;\r\n    this.eventHandlers.onClose = null;\r\n    this.elements.main.classList.add('keyboard-panel_hidden');\r\n    this.properties.isOpen = false;\r\n  }\r\n};\r\n\r\n//https://learn.javascript.ru/keyboard-events\r\n","export const keyboardEventHandler = (keyboard) => {\r\n\r\n  document.addEventListener('keydown', (event) => {\r\n    if (keyboard.properties.isOpen) {\r\n\r\n      if (keyboard.properties.keyLayout.hasOwnProperty(event.code)) {\r\n\r\n\r\n        event.preventDefault();\r\n        let element = document.getElementById(event.code);\r\n\r\n\r\n        if (element) {\r\n          keyboard.animateKeyDown(element);\r\n\r\n          switch (element.id) {\r\n            case 'ShiftRight':\r\n            case 'ShiftLeft':\r\n\r\n              // to prevent multiple event triggering\r\n              if (!keyboard.properties.shift) {\r\n\r\n                if (event.ctrlKey) {\r\n                  keyboard.changeLanguageLayout();\r\n                }\r\n\r\n                element.dispatchEvent(new Event('mousedown'));\r\n              }\r\n              break;\r\n\r\n            default:\r\n              element.dispatchEvent(new Event('click'));\r\n              break;\r\n          }\r\n        }\r\n      }\r\n    }\r\n  });\r\n  document.addEventListener('keyup', (event) => {\r\n    if (keyboard.properties.isOpen) {\r\n      if (keyboard.properties.keyLayout.hasOwnProperty(event.code)) {\r\n        event.preventDefault();\r\n        let element = document.getElementById(event.code);\r\n        if (element) {\r\n          keyboard.animateKeyUp(element);\r\n          switch (element.id) {\r\n            case 'ShiftRight':\r\n            case 'ShiftLeft':\r\n\r\n              element.dispatchEvent(new Event('mouseup'));\r\n              break;\r\n            case 'CapsLock':\r\n              element.dispatchEvent(new Event('mouseup'));\r\n              break;\r\n            default:\r\n\r\n              break;\r\n\r\n          }\r\n        }\r\n      }\r\n    }\r\n  });\r\n};","\r\n// control keys must be the same\r\nexport const keyboardLayoutEnRu = {       \r\n  'Backquote'   : ['`', '~',  'ё',  'Ё'],\r\n  'Digit1'      : ['1',  '!',  '1',  '!'],\r\n  'Digit2'      : ['2',  '@',  '2',  '\\\"'],\r\n  'Digit3'      : ['3',  '#',  '3',  '№'],\r\n  'Digit4'      : ['4',  '$',  '4',  ';'],\r\n  'Digit5'      : ['5',  '%',  '5',  '%'],\r\n  'Digit6'      : ['6',  '^',  '6',  ':'],\r\n  'Digit7'      : ['7',  '&',  '7',  '?'],\r\n  'Digit8'      : ['8',  '*',  '8',  '*'],\r\n  'Digit9'      : ['9',  '(',  '9',  '('],      \r\n  'Digit0'      : ['0',  ')',  '0',  ')'],\r\n  'Minus'       : ['-',  '_',  '-',  '_'],\r\n  'Equal'       : ['=',  '+',  '=',  '+'],\r\n  'Backspace'   : ['Backspace',  'Backspace',  'Backspace',  'Backspace'],\r\n  'Lang'   : ['En',  'En',  'Рус',  'Рус'],\r\n  'Tab'         : ['Tab',  'Tab',  'Tab',  'Tab'],\r\n  'KeyQ'        : ['q',  'Q',  'й',  'Й'],\r\n  'KeyW'        : ['w',  'W',  'ц',  'Ц'],\r\n  'KeyE'        : ['e',  'E',  'у',  'У'],\r\n  'KeyR'        : ['r',  'R',  'к',  'К'],\r\n  'KeyT'        : ['t',  'T',  'е',  'Е'],\r\n  'KeyY'        : ['y',  'Y',  'н',  'Н'],\r\n  'KeyU'        : ['u',  'U',  'г',  'Г'],\r\n  'KeyI'        : ['i',  'I',  'ш',  'Ш'],\r\n  'KeyO'        : ['o',  'O',  'щ',  'Щ'],\r\n  'KeyP'        : ['p',  'P',  'з',  'З'],\r\n  'BracketLeft' : ['[',  '{',  'х',  'Х'],\r\n  'BracketRight': [']',  '}',  'ъ',  'Ъ'],\r\n  'Delete'      : ['Del',  'Del',  'Del',  'Del'],\r\n  'CapsLock'    : ['Caps',  'Caps',  'Caps',  'Caps'],\r\n  'KeyA'        : ['a',  'A',  'ф',  'Ф'],\r\n  'KeyS'        : ['s',  'S',  'ы',  'Ы'],\r\n  'KeyD'        : ['d',  'D',  'в',  'В'],\r\n  'KeyF'        : ['f',  'F',  'а',  'А'],\r\n  'KeyG'        : ['g',  'G',  'п',  'П'],\r\n  'KeyH'        : ['h',  'H',  'р',  'Р'],\r\n  'KeyJ'        : ['j',  'J',  'о',  'О'],\r\n  'KeyK'        : ['k',  'K',  'л',  'Л'],\r\n  'KeyL'        : ['l',  'L',  'д',  'Д'],\r\n  'Semicolon'   : [';',  ':',  'ж',  'Ж'],\r\n  'Quote'       : ['\\'',  '\\\"',  'э',  'Э'],\r\n  'Backslash'   : ['\\\\',  '|',  '\\\\',  '/'],\r\n  'Enter'       : ['Enter',  'Enter',  'Enter',  'Enter'],\r\n  'ShiftLeft'   : ['Shift',  'Shift',  'Shift',  'Shift'],\r\n  'KeyZ'        : ['z',  'Z',  'я',  'Я'],\r\n  'KeyX'        : ['x',  'X',  'ч',  'Ч'],\r\n  'KeyC'        : ['c',  'C',  'с',  'С'],\r\n  'KeyV'        : ['v',  'V',  'м',  'М'],\r\n  'KeyB'        : ['b',  'B',  'и',  'И'],\r\n  'KeyN'        : ['n',  'N',  'т',  'Т'],\r\n  'KeyM'        : ['m',  'M',  'ь',  'Ь'],\r\n  'Comma'       : [',',  '<',  'б',  'Б'],\r\n  'Period'      : ['.',  '>',  'ю',  'Ю'],\r\n  'Slash'       : ['/',  '?',  '.',  ','],\r\n  'ShiftRight'  : ['Shift',  'Shift',  'Shift',  'Shift'],\r\n  'ArrowUp'     : ['ArrowUp',  'ArrowUp',  'ArrowUp',  'ArrowUp'],\r\n  //'IntlBackslash': ['<','>','/','|'],\r\n  'Led': ['led','led','led','led'],\r\n  'ControlLeft' : ['Ctrl',  'Ctrl',  'Ctrl',  'Ctrl'],\r\n  'AltLeft'     : ['Alt',  'Alt',  'Alt',  'Alt'],\r\n  'Space'       : ['Space',  'Space',  'Space',  'Space'],\r\n  'AltRight'    : ['Alt',  'Alt',  'Alt',  'Alt'],\r\n  'ControlRight' : ['Ctrl',  'Ctrl',  'Ctrl',  'Ctrl'],\r\n  'Done'        : ['done',  'done',  'done',  'done'],\r\n  'ArrowLeft'   : ['ArrowLeft',  'ArrowLeft',  'ArrowLeft',  'ArrowLeft'],\r\n  'ArrowDown'   : ['ArrowDown',  'ArrowDown',  'ArrowDown',  'ArrowDown'],\r\n  'ArrowRight'  : ['ArrowRight',  'ArrowRight',  'ArrowRight',  'ArrowRight']\r\n};\r\n\r\nexport const brakingElementsArr = ['Lang', 'Delete', 'Enter', 'Led'];\r\nexport const languagesArr = ['En','Ru'];\r\n\r\nexport const getLanguage = () =>\r\n{\r\n  let lang;\r\n  switch (navigator.language)\r\n    {\r\n      case 'ru-RU':\r\n        lang = 'Ru';\r\n        break;\r\n      case 'en-EN':\r\n        lang = 'En';\r\n        break;  \r\n      default:\r\n        lang = 'En';\r\n        break; \r\n    }\r\n  return lang;  \r\n}"],"sourceRoot":""}